<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GT RoboCup SSL: GDB Exercise</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rj_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GT RoboCup SSL
   </div>
   <div id="projectbrief">Soccer software, robot firmware</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md__g_d_b_exercise.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">GDB Exercise </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The associated source files for this exercise can be cloned from <a href="https://github.com/CollinAvidano/GDB-Tutorial">here</a></p>
<h2>Introduction</h2>
<p>GDB is a standard debugging program that is included by default in all Linux platforms.</p>
<p>We are teaching it to you now so that when your code breaks you have a tool that you can use to diagnose the problem. In this exercise, we are providing to you two very simple C programs and asking you to debug the errors. (Being proficient at gdb is also a skill that can be put on a resume.)</p>
<h2>Instructions</h2>
<h3>gdb_example1</h3>
<p>First, compile gdb_example1 with debugging options using gcc. Ignore any warnings for now. </p><div class="fragment"><div class="line">gcc -o gdb_example1 gdb_example1.c -g</div></div><!-- fragment --><p>Try running the provided gdb_example1 using </p><div class="fragment"><div class="line">&gt;&gt;&gt; ./gdb_example1</div></div><!-- fragment --><p>You should get an segmentation fault. This is a very common problem. To easily figure out where this problem is, run </p><div class="fragment"><div class="line">&gt;&gt;&gt; gdb ./gdb_example1</div></div><!-- fragment --><p>GDB will show you the welcome prompt. To run the binary under gdb, type `r' or `run'. Gdb will automatically break at the segfault.</p>
<p>At this point, we want to know what caused the segfault. We can do one of several ways. We can either type `list' at the gdb prompt (shows $$ 10 lines around current stopped point), or open up the file in a text editor. Proceed either way to figure out what is going on around this segfault. Try to debug the error. After you have diagnosed the problem, make the required changes so that gdb_example1.c does not segfault. (Hint: don't make any changes that affect the functionality - if some piece of code is going cause a segfault, don't do it or delete the line.)</p>
<p>If you can't figure out, an example fix is shown at the bottom of this README.</p>
<p>After we have made the fix, we need to compile and build this program again. Gcc provides a debugging option so that in gdb, you can access variables and functions by names from the source file (instead of memory addresses). To compile these c files with debugging symbols for gdb, gcc need to be run with '-g' option. </p><div class="fragment"><div class="line">gcc -o &lt;out_binary_name&gt; &lt;in_file_name&gt;.c -g</div></div><!-- fragment --><p>In our case, we want </p><div class="fragment"><div class="line">gcc -o gdb_example1 gdb_example1.c -g</div></div><!-- fragment --><p>Run gdb_example1 again. If your fix worked, there will be no segmentation fault. Congratulations, you have made your first GDB fix!</p>
<h2>gdb_example2</h2>
<p>Next, try your hand at gdb_example2. We will take a different approach to debugging this example than gdb_example1 for the sake of exposing you to additional gdb functionality. Again, first compile it (ignore any warnings), then run it: </p><div class="fragment"><div class="line">&gt;&gt;&gt; gcc -o gdb_example2 gdb_example2.c -g</div><div class="line">&gt;&gt;&gt; ./gdb_example2</div></div><!-- fragment --><p> To debug, </p><div class="fragment"><div class="line">&gt;&gt;&gt; gdb gdb_example2</div><div class="line">(gdb) run</div></div><!-- fragment --><p>We are interested in what are the values of the two variables causing the segfault. We see that gdb has broken on line 5, *ip = i; To see the values of the variables, </p><div class="fragment"><div class="line">(gdb) print i</div><div class="line">(gdb) print ip</div></div><!-- fragment --><p>From the value of ip, we can see that it is just pointing at some address, which may be causing the segfault. (Where was this address ever defined? Was this address ever defined?) We also see that this segfault is happening during a function call. To have gdb list the full function stack, </p><div class="fragment"><div class="line">(gdb) info stack</div></div><!-- fragment --><p> We can see now that setInt() is called by main(), so it seems that main also called this function with invalid arguments. To see the arguments to the current function call, </p><div class="fragment"><div class="line">(gdb) info args</div></div><!-- fragment --><p> We have a lot of information about the state of the binary when the segfault occurs now. To list them, we know:</p><ul>
<li>The value of the variables causing the segfault</li>
<li>The place in code where the function was called</li>
<li>The value of the function arguments of the current function</li>
</ul>
<p>Make any fixes to allow the binary to run. Compile the binary (remember debugging options!) and run it to verify that your fixes solved the segfault.</p>
<h2>Debug a Program</h2>
<p>BuggyBST is provided as a final exercise to play around with GDB. An excellent way to learn how to use gdb is to google `gdb cheatsheet' and read over the different commands that gdb provides. Some very useful ones are: `gdb &ndash;args'</p>
<p>next/step/continue</p>
<p>breakpoints</p>
<p>conditional breakpoints</p>
<p>watchpoints</p>
<p>examining memory</p>
<p>`display'</p>
<p>Compile buggyBST.c and ignore all warnings for the sake of this exercise</p><ul>
<li>use gdb to quickly find all of the errors. Make any changes to the line required to fix the segfault.</li>
</ul>
<p>HINT: Most of the errors can be fixed by one character changes - they should seem like you are fixing a typo.</p>
<h2>Example Fixes</h2>
<p>### gdb_example1.c fix: </p><div class="fragment"><div class="line">void print_scrambled(char *message)</div><div class="line">{</div><div class="line">  int i = 3;</div><div class="line">  if (message != NULL) {            // check for NULL pointer</div><div class="line">      do {</div><div class="line">        printf(&quot;%c&quot;, (*message)+i);</div><div class="line">      } while (*++message);</div><div class="line">      printf(&quot;\n&quot;);</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><h3>gdb_example2.c fix:</h3>
<div class="fragment"><div class="line">void setint(int* ip, int i) {</div><div class="line">    *ip = i;</div><div class="line">}</div><div class="line"></div><div class="line">void write_message(char *message) {</div><div class="line">    char buffer[100];</div><div class="line"></div><div class="line">    memset(buffer, &#39;\0&#39;, 100);</div><div class="line">    strcpy(buffer, message);</div><div class="line">    printf(&quot;%s\n&quot;, buffer);</div><div class="line">}</div><div class="line"></div><div class="line">int main() {</div><div class="line">    int a;</div><div class="line">    char message[] = &quot;Look, this seems like an innocent message!&quot;;</div><div class="line"></div><div class="line">    setint(&amp;a, 10);</div><div class="line">    printf(&quot;%d\n&quot;, a);</div><div class="line"></div><div class="line">    write_message(message);</div><div class="line"></div><div class="line">    int *b;</div><div class="line">    int c;</div><div class="line">    b = &amp;c;             // point B to a valid integer object</div><div class="line">                        // instead of leaving it to point to whatever is</div><div class="line">                        // leftover on the stack</div><div class="line"></div><div class="line">    setint(b, 20);</div><div class="line">    printf(&quot;%ld\n&quot;, *b);</div><div class="line">    printf(&quot;This may or may not have crashed. You are lucky if you see this.&quot;);</div><div class="line">    return 0;</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Sep 22 2020 21:22:55 for GT RoboCup SSL by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
